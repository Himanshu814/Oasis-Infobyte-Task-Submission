# -*- coding: utf-8 -*-
"""Sales_prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1KFU0W2n6Lt0voE34tpp1NQLn2hA0One9

### **SALES PREDICTION**

Importing Library
"""

import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

"""Importing Dataset"""

dataset= pd.read_csv("/content/Advertising.csv")
dataset

"""Data Analysis"""

#To Display General Stats
dataset.describe()

# To Check for Null Values
dataset.isnull().sum()

# Check Number of Rows and Columns
dataset.shape

dataset.head()

dataset.info()

# Columns
dataset.keys()

#Correlation Matrix
corr_matrix=dataset.corr()
sns.heatmap(corr_matrix, annot= True)

"""Scatter Plots"""

# For Sales v/s TV 
sns.scatterplot(data=dataset, x=dataset['TV'], y=dataset['Sales'])
plt.show()

# For Sales v/s Radio 
sns.scatterplot(data=dataset, x=dataset['Radio'], y=dataset['Sales'])
plt.show()

# For Sales v/s Newspaper
sns.scatterplot(data=dataset, x=dataset['Newspaper'], y=dataset['Sales'])
plt.show()

"""Regression"""

from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression

X= dataset[['TV', 'Radio', 'Newspaper']]
X

Y=dataset['Sales']
Y

# Fitting the Model
X_train, X_test, Y_train, Y_test = train_test_split(X,Y,train_size=0.7, random_state=0)

model= LinearRegression()
model.fit(X_train,Y_train)

#predictions
Y_predict= model.predict(X_test)
Y_predict

print(model.intercept_)
print(model.coef_)

"""Model Evaluation

"""

from sklearn import metrics

print("Mean Absolute Error = ",metrics.mean_absolute_error(Y_predict, Y_test))
print("Mean Squared Error = ",metrics.mean_squared_error(Y_predict, Y_test))
print('RMSE = ',np.sqrt(metrics.mean_squared_error(Y_predict, Y_test)))
print('R-Squared = ',metrics.r2_score(Y_predict, Y_test))